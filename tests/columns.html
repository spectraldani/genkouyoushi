<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Test columns</title>
</head>

<body>
    <svg width="800" height="800" xmlns="http://www.w3.org/2000/svg" style="display: block;margin: 0 auto;">
    </svg>
    <script type="module">
        import { SpacingRectangle } from "../geometry.js";
        import { SVGBox, SVGHanziBox, makeBoard, makeLine } from "../svg.js"

        const svg = document.querySelector('svg');
        const SVG_NS = "http://www.w3.org/2000/svg";

        const gridSize = 5;
        const testWidth = gridSize * 27;
        const testHeight = gridSize * 61;
        {
            const g = document.createElementNS(SVG_NS, "g");
            const strokeColor = "#aaaaaa";
            svg.setAttribute("viewBox", `0 0 ${testWidth} ${testHeight}`);
            svg.appendChild(g);
            g.setAttribute("stroke-width", (gridSize / 20).toFixed(4));
            for (let i = 0; i <= testWidth / gridSize; i++) {
                g.appendChild(makeLine(
                    i * gridSize, 0, i * gridSize, testHeight, 0,
                    strokeColor
                ));
            }
            for (let i = 0; i <= testHeight / gridSize; i++) {
                g.appendChild(makeLine(
                    0, i * gridSize, testWidth, i * gridSize, 0,
                    strokeColor
                ));
            }
        }

        let origin = [5, 5];
        const nDashesStraight = 19;
        const nDashesDiagonal = 25;
        const box = new SVGHanziBox(
            10 * gridSize, 10 * gridSize,
            undefined, undefined, undefined,
            false, nDashesStraight, nDashesDiagonal,
            "black", "#aaaaaa",
            true, false, false, false
        );
        box.strokeWidth = gridSize;

        const testBoxFill1 = "color(srgb 1 1 0 / 0.5)"
        const testBoxFill2 = "color(srgb 0 0.66 0.96 / 0.5)"

        // origin[0] += baseBox.outerWidth + 5;
        const boardHeight = (testHeight - 2 * gridSize);
        /* Outline and margins test */ {
            const oneColWidth = box.outerWidth + box.margin.totalHorizontal + box.strokeWidth * 2 + 10;

            const [board, usedWidth, usedHeight] = makeBoard(oneColWidth, boardHeight, box, box.render.bind(box));
            board.setAttribute("transform", `translate(${origin[0]}, ${origin[1]})`);

            const boardBox = new SVGBox(box.innerWidth, undefined, undefined, undefined, box.strokeWidth, box.strokeColor, "none");
            boardBox.outerHeight = usedHeight;

            svg.appendChild(boardBox.render(origin[0], origin[1]))
            svg.appendChild(board);

            svg.appendChild(new SVGBox(
                box.outerWidth, usedHeight,
                undefined, undefined,
                0, "none",
                testBoxFill1
            ).render(origin[0], origin[1]))
            svg.appendChild(new SVGBox(
                box.outerWidth, boardHeight,
                undefined, undefined,
                0, "none",
                testBoxFill2
            ).render(origin[0], origin[1]))
        }

        origin[0] += box.outerWidth + 5;
        /* Outline and margins test */ {
            box.margin = new SpacingRectangle(1 * gridSize, 0, 2 * gridSize, 0);
            box.isEnclosed = true;

            const oneColWidth = box.outerWidth + box.margin.totalHorizontal + box.strokeWidth * 2 + 10;
            const [board, usedWidth, usedHeight] = makeBoard(oneColWidth, boardHeight, box, box.render.bind(box));
            board.setAttribute("transform", `translate(${origin[0]}, ${origin[1]})`);

            const boardBox = new SVGBox(box.innerWidth, undefined, undefined, undefined, box.strokeWidth, box.strokeColor, "none");
            boardBox.outerHeight = usedHeight;

            svg.appendChild(boardBox.render(origin[0], origin[1]))
            svg.appendChild(board);

            svg.appendChild(new SVGBox(
                box.outerWidth, usedHeight,
                undefined, undefined,
                0, "none",
                testBoxFill1
            ).render(origin[0], origin[1]))
            svg.appendChild(new SVGBox(
                box.outerWidth, boardHeight,
                undefined, undefined,
                0, "none",
                testBoxFill2
            ).render(origin[0], origin[1]))
        }

    </script>
</body>

</html>