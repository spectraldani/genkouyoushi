<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Test hanzibox</title>
</head>

<body>
    <svg width="800" height="800" xmlns="http://www.w3.org/2000/svg" style="display: block;margin: 0 auto;">
    </svg>
    <script type="module">
        import { Box, SpacingRectangle } from "../geometry.js";
        import { SVGBox, SVGHanziBox, makeLine } from "../svg.js"

        const svg = document.querySelector('svg');
        const SVG_NS = "http://www.w3.org/2000/svg";

        const testWidth = 48;
        const testHeight = 48;
        {
            const g = document.createElementNS(SVG_NS, "g");
            const strokeColor = "#aaaaaa";
            svg.setAttribute("viewBox", `0 0 ${testWidth} ${testHeight}`);
            svg.appendChild(g);
            g.setAttribute("stroke-width", (1 / 20).toFixed(4));
            for (let i = 0; i <= testWidth; i++) {
                g.appendChild(makeLine(
                    i, 0, i, testHeight, 0,
                    strokeColor
                ));
            }
            for (let i = 0; i <= testHeight; i++) {
                g.appendChild(makeLine(
                    0, i, testWidth, i, 0,
                    strokeColor
                ));
            }
        }


        let origin = [1, 1];

        // Base configuration for test boxes
        const baseBox = new SVGHanziBox(
            10, 10,
            undefined, undefined,
            1,
            true,
            0, 0,
            "black", "#aaaaaa",
            false, false, false, false
        );

        const testBoxFill = "color(srgb 1 0.75 0.8 / 0.5)"

        /* Outer box test */{
            const box = baseBox.clone();
            let [x, y] = origin;

            box.isEnclosed = true;
            let hanziBox = box.render(x, y, true);
            svg.appendChild(hanziBox);
            svg.appendChild(new SVGBox(
                box.outerWidth, box.outerHeight,
                undefined, undefined,
                0, "none", testBoxFill
            ).render(x, y));

            x += box.outerWidth + 5;
            box.isEnclosed = false;
            hanziBox = box.render(x, y, true);
            svg.appendChild(hanziBox);
            svg.appendChild(new SVGBox(box.outerWidth, box.outerHeight, undefined, undefined, 0, "none", testBoxFill).render(x, y));

            x += box.outerWidth + 5;
            box.isEnclosed = true;
            hanziBox = box.render(x, y, true);
            svg.appendChild(hanziBox);

            let [x0, y0] = [x, y];
            svg.appendChild(new SVGBox(
                1, 1,
                undefined, undefined,
                0, "none", testBoxFill
            ).render(x0, y0));

            [x0, y0] = box.innerOrigin;
            x0 += x;
            y0 += y;
            svg.appendChild(new SVGBox(
                1, 1,
                undefined, undefined,
                0, "none", testBoxFill
            ).render(x0, y0));
        }

        origin[1] += baseBox.outerHeight + 5;

        /* Test cross */ {
            const box = baseBox.clone();
            box.addCross = true;
            let [x, y] = origin;

            let hanziBox = box.render(x, y, true);
            svg.appendChild(hanziBox);

            const halfBox = new SVGBox(box.innerWidth / 2, box.innerHeight / 2, undefined, undefined, 0, "none", testBoxFill);

            x += box.innerOrigin[0];
            y += box.innerOrigin[1];
            svg.appendChild(halfBox.render(x, y));
            x += halfBox.innerWidth;
            y += halfBox.innerHeight;
            svg.appendChild(halfBox.render(x, y));
        }

        origin[1] += baseBox.outerHeight + 5;
        /* Test fourth */ {
            const box = baseBox.clone();
            box.addBox = true;
            let [x, y] = origin;

            let hanziBox = box.render(x, y, true);
            svg.appendChild(hanziBox);

            const fourthBox = new SVGBox(box.innerWidth / 4, box.innerHeight / 4, undefined, undefined, 0, "none", testBoxFill);
            x += box.innerOrigin[0];
            y += box.innerOrigin[1];
            for (let i = 0; i < 4; i++) {
                svg.appendChild(fourthBox.render(
                    x + i * fourthBox.innerWidth,
                    y + i * fourthBox.innerHeight
                ));
            }
        }

    </script>
</body>

</html>